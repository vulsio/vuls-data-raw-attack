{
  "type": "relationship",
  "id": "relationship--e84df21f-b55f-4b5d-ae7b-0f8fcc4eed95",
  "created": "2022-03-30T14:26:51.864Z",
  "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
  "description": "Monitor Registry for changes to run keys that do not correlate with known software, patch cycles, etc. Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the run keys' Registry locations. (Citation: TechNet Autoruns)\n\nDetection of the modification of the registry key <code>Common Startup</code> located in HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\\ and HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\\. When a user logs on, any files located in the Startup Folder are launched. Attackers may modify these folders with other files in order to evade detection set on these default folders. This detection focuses on EventIDs 4688 and 1 for process creation and EventID 4657 for the modification of the Registry Keys.\n\n<h4>Analytic 1 - Modification of Default Startup Folder in the Registry Key ‘Common Startup’</h4>\n<code>logon_reg_processes = filter processes where (command_line CONTAINS(\"*reg*\") AND command_line CONTAINS(\"*add*\") AND command_line CONTAINS(\"*/d*\") OR (command_line CONTAINS(\"*Set-ItemProperty*\") AND command_line CONTAINS(\"*-value*\")) AND command_line CONTAINS(\"*Common Startup*\"))\nreg_keys = search Registry:value_edit\nlogon_reg_keys = filter reg_keys where value=\"Common Startup\"</code>",
  "external_references": [
    {
      "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.",
      "source_name": "TechNet Autoruns",
      "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902"
    }
  ],
  "modified": "2023-09-15T17:16:19.133Z",
  "object_marking_refs": [
    "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
  ],
  "relationship_type": "detects",
  "revoked": false,
  "source_ref": "x-mitre-data-component--da85d358-741a-410d-9433-20d6269a6170",
  "spec_version": "",
  "target_ref": "attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279",
  "x_mitre_attack_spec_version": "3.1.0",
  "x_mitre_deprecated": false,
  "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
  "x_mitre_version": "0.1"
}
